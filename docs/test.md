

# 连续体机器人静力学模型高度异常诊断报告

## 1. 异常现象

* 在刚度扫描实验中，末端 **XY 半径随 PSS 刚度变化规律合理**（软则更大）。
* 但 **末端高度 Z\_rel 始终约 +0.08m**，对应末端 Z ≈ 0.28m。
* 这比直立时基座高度 (0.20m) 还要高。
* **矛盾点**：

  * 物理上，弯曲后末端 Z 坐标应 **低于直立时**。
  * 模型结果却显示 **弯曲使末端“升高”**。

---

## 2. 可能原因分析

### 2.1 基准高度定义错误

* 当前对相对高度的计算公式是：

  ```
  z_coords_rel = z_end - base_z
  base_z = Lp
  ```
* 但直立时末端高度应为：

  ```
  H_straight = Lp + Lc1 + Lc2
  ```
* 如果基准取成了 `Lp` 而非全长，计算结果会出现 **虚假的正偏移**。

---

### 2.2 弯曲几何公式缺陷

* Constant Curvature (CC) 模型中：

  ```
  Z(k, L) = (sin(kL)) / k
  ```

  * 当 k>0 时，Z < L，必然缩短。
* 如果 `forward_kinematics` 实现中，Z 分量写成了 **弧长直接累加**，而没用 CC 投影公式，
  那末端高度就会“保持接近全长”，甚至在矩阵乘法中被抬高。

---

### 2.3 坐标系方向定义问题

* 模型中重力方向设为 `[0, 0, g]`。
* 如果在 `forward_kinematics` 里，Z 轴定义与全局坐标相反，可能导致：

  * 实际下弯 → 模型显示上翘。
  * 出现与物理相反的 Z 坐标变化。

---

### 2.4 锚点与电缆几何的副作用

* 在 `calculate_drive_mapping` 里，电缆长度差值定义为：

  ```
  l0 = (Lp - z_anchor) + Lc1 (+ Lc2)
  ```
* 如果几何基点选错，电缆拉动时可能会人为抬升末端位置。
* 这会与 CC 模型几何叠加，造成末端“比直立更高”的假象。

---

## 3. 推荐排查步骤

1. **直立状态验证**

   * 输入 `q=[0,0,0,0,0,0]`，打印末端 Z。
   * 检查是否等于 **Lp+Lc1+Lc2**。
   * 若不等，说明基准高度或 CC 投影公式有误。

2. **单段弯曲验证**

   * 设 `kp=0.2, kc1=kc2=0`。
   * 理论上，末端 Z 必须 **低于直立时**。
   * 若反而更高 → 说明该段的 CC 投影公式实现错误。

3. **逐段坐标输出**

   * 在 `forward_kinematics` 中打印：

     * PSS末端 Z
     * CMS1末端 Z
     * CMS2末端 Z
   * 确认哪一段导致异常。

---

## 4. 初步结论

* 问题 **不在刚度数值**，而在 **几何/运动学实现**。
* 最可能的根源：

  1. `base_z` 定义错误（Lp 而非全长）。
  2. Constant Curvature 投影公式未正确实现，Z 分量没有体现“曲率缩短”。

---

👉 建议：先做 **直立状态验证** 和 **单段弯曲验证**，一步步定位。

---
