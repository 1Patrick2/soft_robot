

# è¿žç»­ä½“æœºå™¨äººé™åŠ›å­¦æ¨¡åž‹é«˜åº¦å¼‚å¸¸è¯Šæ–­æŠ¥å‘Š

## 1. å¼‚å¸¸çŽ°è±¡

* åœ¨åˆšåº¦æ‰«æå®žéªŒä¸­ï¼Œæœ«ç«¯ **XY åŠå¾„éš PSS åˆšåº¦å˜åŒ–è§„å¾‹åˆç†**ï¼ˆè½¯åˆ™æ›´å¤§ï¼‰ã€‚
* ä½† **æœ«ç«¯é«˜åº¦ Z\_rel å§‹ç»ˆçº¦ +0.08m**ï¼Œå¯¹åº”æœ«ç«¯ Z â‰ˆ 0.28mã€‚
* è¿™æ¯”ç›´ç«‹æ—¶åŸºåº§é«˜åº¦ (0.20m) è¿˜è¦é«˜ã€‚
* **çŸ›ç›¾ç‚¹**ï¼š

  * ç‰©ç†ä¸Šï¼Œå¼¯æ›²åŽæœ«ç«¯ Z åæ ‡åº” **ä½ŽäºŽç›´ç«‹æ—¶**ã€‚
  * æ¨¡åž‹ç»“æžœå´æ˜¾ç¤º **å¼¯æ›²ä½¿æœ«ç«¯â€œå‡é«˜â€**ã€‚

---

## 2. å¯èƒ½åŽŸå› åˆ†æž

### 2.1 åŸºå‡†é«˜åº¦å®šä¹‰é”™è¯¯

* å½“å‰å¯¹ç›¸å¯¹é«˜åº¦çš„è®¡ç®—å…¬å¼æ˜¯ï¼š

  ```
  z_coords_rel = z_end - base_z
  base_z = Lp
  ```
* ä½†ç›´ç«‹æ—¶æœ«ç«¯é«˜åº¦åº”ä¸ºï¼š

  ```
  H_straight = Lp + Lc1 + Lc2
  ```
* å¦‚æžœåŸºå‡†å–æˆäº† `Lp` è€Œéžå…¨é•¿ï¼Œè®¡ç®—ç»“æžœä¼šå‡ºçŽ° **è™šå‡çš„æ­£åç§»**ã€‚

---

### 2.2 å¼¯æ›²å‡ ä½•å…¬å¼ç¼ºé™·

* Constant Curvature (CC) æ¨¡åž‹ä¸­ï¼š

  ```
  Z(k, L) = (sin(kL)) / k
  ```

  * å½“ k>0 æ—¶ï¼ŒZ < Lï¼Œå¿…ç„¶ç¼©çŸ­ã€‚
* å¦‚æžœ `forward_kinematics` å®žçŽ°ä¸­ï¼ŒZ åˆ†é‡å†™æˆäº† **å¼§é•¿ç›´æŽ¥ç´¯åŠ **ï¼Œè€Œæ²¡ç”¨ CC æŠ•å½±å…¬å¼ï¼Œ
  é‚£æœ«ç«¯é«˜åº¦å°±ä¼šâ€œä¿æŒæŽ¥è¿‘å…¨é•¿â€ï¼Œç”šè‡³åœ¨çŸ©é˜µä¹˜æ³•ä¸­è¢«æŠ¬é«˜ã€‚

---

### 2.3 åæ ‡ç³»æ–¹å‘å®šä¹‰é—®é¢˜

* æ¨¡åž‹ä¸­é‡åŠ›æ–¹å‘è®¾ä¸º `[0, 0, g]`ã€‚
* å¦‚æžœåœ¨ `forward_kinematics` é‡Œï¼ŒZ è½´å®šä¹‰ä¸Žå…¨å±€åæ ‡ç›¸åï¼Œå¯èƒ½å¯¼è‡´ï¼š

  * å®žé™…ä¸‹å¼¯ â†’ æ¨¡åž‹æ˜¾ç¤ºä¸Šç¿˜ã€‚
  * å‡ºçŽ°ä¸Žç‰©ç†ç›¸åçš„ Z åæ ‡å˜åŒ–ã€‚

---

### 2.4 é”šç‚¹ä¸Žç”µç¼†å‡ ä½•çš„å‰¯ä½œç”¨

* åœ¨ `calculate_drive_mapping` é‡Œï¼Œç”µç¼†é•¿åº¦å·®å€¼å®šä¹‰ä¸ºï¼š

  ```
  l0 = (Lp - z_anchor) + Lc1 (+ Lc2)
  ```
* å¦‚æžœå‡ ä½•åŸºç‚¹é€‰é”™ï¼Œç”µç¼†æ‹‰åŠ¨æ—¶å¯èƒ½ä¼šäººä¸ºæŠ¬å‡æœ«ç«¯ä½ç½®ã€‚
* è¿™ä¼šä¸Ž CC æ¨¡åž‹å‡ ä½•å åŠ ï¼Œé€ æˆæœ«ç«¯â€œæ¯”ç›´ç«‹æ›´é«˜â€çš„å‡è±¡ã€‚

---

## 3. æŽ¨èæŽ’æŸ¥æ­¥éª¤

1. **ç›´ç«‹çŠ¶æ€éªŒè¯**

   * è¾“å…¥ `q=[0,0,0,0,0,0]`ï¼Œæ‰“å°æœ«ç«¯ Zã€‚
   * æ£€æŸ¥æ˜¯å¦ç­‰äºŽ **Lp+Lc1+Lc2**ã€‚
   * è‹¥ä¸ç­‰ï¼Œè¯´æ˜ŽåŸºå‡†é«˜åº¦æˆ– CC æŠ•å½±å…¬å¼æœ‰è¯¯ã€‚

2. **å•æ®µå¼¯æ›²éªŒè¯**

   * è®¾ `kp=0.2, kc1=kc2=0`ã€‚
   * ç†è®ºä¸Šï¼Œæœ«ç«¯ Z å¿…é¡» **ä½ŽäºŽç›´ç«‹æ—¶**ã€‚
   * è‹¥åè€Œæ›´é«˜ â†’ è¯´æ˜Žè¯¥æ®µçš„ CC æŠ•å½±å…¬å¼å®žçŽ°é”™è¯¯ã€‚

3. **é€æ®µåæ ‡è¾“å‡º**

   * åœ¨ `forward_kinematics` ä¸­æ‰“å°ï¼š

     * PSSæœ«ç«¯ Z
     * CMS1æœ«ç«¯ Z
     * CMS2æœ«ç«¯ Z
   * ç¡®è®¤å“ªä¸€æ®µå¯¼è‡´å¼‚å¸¸ã€‚

---

## 4. åˆæ­¥ç»“è®º

* é—®é¢˜ **ä¸åœ¨åˆšåº¦æ•°å€¼**ï¼Œè€Œåœ¨ **å‡ ä½•/è¿åŠ¨å­¦å®žçŽ°**ã€‚
* æœ€å¯èƒ½çš„æ ¹æºï¼š

  1. `base_z` å®šä¹‰é”™è¯¯ï¼ˆLp è€Œéžå…¨é•¿ï¼‰ã€‚
  2. Constant Curvature æŠ•å½±å…¬å¼æœªæ­£ç¡®å®žçŽ°ï¼ŒZ åˆ†é‡æ²¡æœ‰ä½“çŽ°â€œæ›²çŽ‡ç¼©çŸ­â€ã€‚

---

ðŸ‘‰ å»ºè®®ï¼šå…ˆåš **ç›´ç«‹çŠ¶æ€éªŒè¯** å’Œ **å•æ®µå¼¯æ›²éªŒè¯**ï¼Œä¸€æ­¥æ­¥å®šä½ã€‚

---
